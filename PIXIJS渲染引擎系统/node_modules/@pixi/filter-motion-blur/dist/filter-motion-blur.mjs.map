{"version":3,"file":"filter-motion-blur.mjs","sources":["../src/MotionBlurFilter.ts"],"sourcesContent":["import { vertex } from '@tools/fragments';\nimport fragment from './motion-blur.frag';\nimport { Filter, ObservablePoint, Point } from '@pixi/core';\nimport type { IPoint, CLEAR_MODES, FilterSystem, RenderTexture } from '@pixi/core';\n\n/**\n * The MotionBlurFilter applies a Motion blur to an object.<br>\n * ![original](../tools/screenshots/dist/original.png)![filter](../tools/screenshots/dist/motion-blur.png)\n *\n * @class\n * @extends PIXI.Filter\n * @see {@link https://www.npmjs.com/package/@pixi/filter-motion-blur|@pixi/filter-motion-blur}\n * @see {@link https://www.npmjs.com/package/pixi-filters|pixi-filters}\n */\nclass MotionBlurFilter extends Filter\n{\n    /**\n     * The kernelSize of the blur, higher values are slower but look better.\n     * Use odd value greater than 5.\n     */\n    public kernelSize = 5;\n\n    private _velocity: IPoint;\n\n    /**\n     * @param {PIXI.ObservablePoint|PIXI.Point|number[]} [velocity=[0, 0]] - Sets the velocity of the motion for blur effect.\n     * @param {number} [kernelSize=5] - The kernelSize of the blur filter. Must be odd number >= 5\n     * @param {number} [offset=0] - The offset of the blur filter.\n     */\n    constructor(velocity: number[] | Point | ObservablePoint = [0, 0], kernelSize = 5, offset = 0)\n    {\n        super(vertex, fragment);\n        this.uniforms.uVelocity = new Float32Array(2);\n        this._velocity = new ObservablePoint(this.velocityChanged, this);\n        this.setVelocity(velocity);\n\n        this.kernelSize = kernelSize;\n        this.offset = offset;\n    }\n\n    /**\n     * Override existing apply method in PIXI.Filter\n     * @private\n     */\n    apply(filterManager: FilterSystem, input: RenderTexture, output: RenderTexture, clear: CLEAR_MODES): void\n    {\n        const { x, y } = this.velocity;\n\n        this.uniforms.uKernelSize = (x !== 0 || y !== 0) ? this.kernelSize : 0;\n        filterManager.applyFilter(this, input, output, clear);\n    }\n\n    /**\n     * Sets the velocity of the motion for blur effect.\n     *\n     * @member {PIXI.ObservablePoint|PIXI.Point|number[]}\n     */\n    set velocity(value: IPoint)\n    {\n        this.setVelocity(value);\n    }\n    get velocity(): IPoint\n    {\n        return this._velocity;\n    }\n\n    /**\n     * Set velocity with more broad types\n     */\n    private setVelocity(value: IPoint | number[])\n    {\n        if (Array.isArray(value))\n        {\n            const [x, y] = value;\n\n            this._velocity.set(x, y);\n        }\n        else\n        {\n            this._velocity.copyFrom(value);\n        }\n    }\n\n    /**\n     * Handle velocity changed\n     * @private\n     */\n    private velocityChanged()\n    {\n        this.uniforms.uVelocity[0] = this._velocity.x;\n        this.uniforms.uVelocity[1] = this._velocity.y;\n\n        // The padding will be increased as the velocity and intern the blur size is changed\n        this.padding = (Math.max(Math.abs(this._velocity.x), Math.abs(this._velocity.y)) >> 0) + 1;\n    }\n\n    /**\n     * The offset of the blur filter.\n     * @default 0\n     */\n    set offset(value: number)\n    {\n        this.uniforms.uOffset = value;\n    }\n\n    get offset(): number\n    {\n        return this.uniforms.uOffset;\n    }\n}\n\nexport { MotionBlurFilter };\n\n"],"names":["MotionBlurFilter","Filter","velocity","kernelSize","offset","vertex","fragment","ObservablePoint","filterManager","input","output","clear","x","y","value"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAcA,MAAMA,UAAyBC,CAC/B,CAcI,YAAYC,EAA+C,CAAC,EAAG,CAAC,EAAGC,EAAa,EAAGC,EAAS,EAC5F,CACI,MAAMC,EAAQC,CAAQ,EAX1B,KAAO,WAAa,EAYhB,KAAK,SAAS,UAAY,IAAI,aAAa,CAAC,EAC5C,KAAK,UAAY,IAAIC,EAAgB,KAAK,gBAAiB,IAAI,EAC/D,KAAK,YAAYL,CAAQ,EAEzB,KAAK,WAAaC,EAClB,KAAK,OAASC,CAClB,CAMA,MAAMI,EAA6BC,EAAsBC,EAAuBC,EAChF,CACI,KAAM,CAAE,EAAAC,EAAG,EAAAC,CAAE,EAAI,KAAK,SAEtB,KAAK,SAAS,YAAeD,IAAM,GAAKC,IAAM,EAAK,KAAK,WAAa,EACrEL,EAAc,YAAY,KAAMC,EAAOC,EAAQC,CAAK,CACxD,CAOA,IAAI,SAASG,EACb,CACI,KAAK,YAAYA,CAAK,CAC1B,CACA,IAAI,UACJ,CACI,OAAO,KAAK,SAChB,CAKQ,YAAYA,EACpB,CACI,GAAI,MAAM,QAAQA,CAAK,EACvB,CACI,KAAM,CAACF,EAAGC,CAAC,EAAIC,EAEf,KAAK,UAAU,IAAIF,EAAGC,CAAC,CAC3B,MAGI,KAAK,UAAU,SAASC,CAAK,CAErC,CAMQ,iBACR,CACI,KAAK,SAAS,UAAU,GAAK,KAAK,UAAU,EAC5C,KAAK,SAAS,UAAU,GAAK,KAAK,UAAU,EAG5C,KAAK,SAAW,KAAK,IAAI,KAAK,IAAI,KAAK,UAAU,CAAC,EAAG,KAAK,IAAI,KAAK,UAAU,CAAC,CAAC,GAAK,GAAK,CAC7F,CAMA,IAAI,OAAOA,EACX,CACI,KAAK,SAAS,QAAUA,CAC5B,CAEA,IAAI,QACJ,CACI,OAAO,KAAK,SAAS,OACzB,CACJ"}